<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.common.login.mapper.LoginMapper">

	<select id="login" parameterType="kr.or.ddit.common.login.vo.MemberVO" resultType="kr.or.ddit.common.login.vo.MemberVO"> 
		SELECT
		    mem_id
		  , file_gr_num
		  , pwd
		  , name
		  , ph_num
		  , addr
		  , addr_detail
		  , zipcode
		  , email
		  , pwd_err_cnt
		  , alert_use_yn
		  , res_rgst_num
		  , gen
		  , del_yn
		  , del_date
		  , bank_code
		  , bank_accnt_num
		  , mem_type_code
		  , del_type_code
		  , create_date
		  , mod_date
		  , first_login_insert_val
		FROM
		    member 
		WHERE mem_id = #{memId} 
		AND (PWD = #{pwd} OR FIRST_LOGIN_INSERT_VAL = #{pwd})
	</select>
	
	<select id="loginTestDelYn" parameterType="kr.or.ddit.common.login.vo.MemberVO" resultType="int"> 
		SELECT COUNT(*)
		FROM MEMBER 
		WHERE MEM_ID = #{memId} 
		AND del_yn = 'N'
	</select>
	
	<select id="loginTestErrCnt" parameterType="kr.or.ddit.common.login.vo.MemberVO" resultType="int"> 
		SELECT COUNT(*)
		FROM MEMBER 
		WHERE MEM_ID = #{memId} 
		AND pwd_err_cnt = 5
	</select>
	
	<select id="loginCnt" parameterType="kr.or.ddit.common.login.vo.MemberVO" resultType="int"> 
		SELECT COUNT(*)
		
		FROM MEMBER 
		
		WHERE MEM_ID = #{memId} 
		
		AND (PWD = #{pwd} OR FIRST_LOGIN_INSERT_VAL = #{pwd})
	</select>
	
	
<!-- 	
	<select id="selectFirstLogin" parameterType="kr.or.ddit.common.login.vo.MemberVO" resultType="kr.or.ddit.common.login.vo.MemberVO"> 
		SELECT COUNT(*) FROM MEMBER
		WHERE mem_id = #{memId}
		AND FIRST_LOGIN_INSERT_VAL = #{firstLoginInsertVal}
		AND pwd is null
	</select> -->

	<update id="errorCnt" parameterType="kr.or.ddit.common.login.vo.MemberVO">
		UPDATE member
		SET
		pwd_err_cnt = #{pwdErrCnt}
		WHERE
		MEM_ID = #{memId}
	</update>
	
</mapper>